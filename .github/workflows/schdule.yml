name: Run on Schedule (and Manual)

on:
  schedule:
    # Runs every day at 10:00 PM IST (IST = UTC+5:30 â†’ 22:00 IST = 16:30 UTC)
    - cron: "30 16 * * *"
  workflow_dispatch:  # allow manual runs from the Actions tab

jobs:
  say-hello:
    runs-on: ubuntu-latest
    permissions:
      contents: write   # needed only because we push a log back to the repo
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Print date & hello
        run: |
          echo "Hello from GitHub Actions!"
          echo "UTC Now: $(date -u)"
          echo "IST Now (computed): $(TZ=Asia/Kolkata date)"

      - name: Create a log file
        run: |
          mkdir -p logs
          echo "Run at UTC $(date -u)" >> logs/run.log

      - name: Commit the log back
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git add logs/run.log
          git commit -m "chore: log scheduled run" || echo "No changes to commit"
          git push
